{
  "description": "Comprehensive security testing for SL-DLAC",
  "testDate": "2025-07-20T21:18:41.451Z",
  "unauthorizedAccess": {
    "description": "Tests for unauthorized access attempts",
    "data": [
      {
        "testName": "Attacker tries to access patient data without role",
        "success": false,
        "duration": 6.916917000000012,
        "gasUsed": 0,
        "error": "call revert exception; VM Exception while processing transaction: reverted with reason string \"No DID found for address\" [ See: https://links.ethers.org/v5-errors-CALL_EXCEPTION ] (method=\"getPatientData(address,string,bytes)\", data=\"0x08c379a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000184e6f2044494420666f756e6420666f7220616464726573730000000000000000\", errorArgs=[\"No DID found for address\"], errorName=\"Error\", errorSignature=\"Error(string)\", reason=\"No DID found for address\", code=CALL_EXCEPTION, version=abi/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:41.668Z"
      },
      {
        "testName": "Attacker tries to update patient data without permission",
        "success": false,
        "duration": 15.332625000000007,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'No DID found for address'\", method=\"estimateGas\", transaction={\"from\":\"0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\",\"to\":\"0x840748F7Fd3EA956E5f4c88001da5CC1ABCBc038\",\"data\":\"0xc7d7421c00000000000000000000000090f79bf6eb2c4f870365e785982e1f101e93b906000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000b766974616c2d7369676e73000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e6d616c6963696f757320646174610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020ba7f0f438183b1345170b7320d50764f2fcdf4498a57a8bc2344d2c54bffc830\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'No DID found for address'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'No DID found for address'\",\"data\":\"0x08c379a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000184e6f2044494420666f756e6420666f7220616464726573730000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:42.684Z"
      },
      {
        "testName": "Attacker tries to create patient record without permission",
        "success": false,
        "duration": 10.712291000000278,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'No DID found for address'\", method=\"estimateGas\", transaction={\"from\":\"0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\",\"to\":\"0x840748F7Fd3EA956E5f4c88001da5CC1ABCBc038\",\"data\":\"0x7eb3a9820000000000000000000000009965507d1a55bcc2695c58ba16fb37d819b0a4dc\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'No DID found for address'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'No DID found for address'\",\"data\":\"0x08c379a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000184e6f2044494420666f756e6420666f7220616464726573730000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:43.695Z"
      },
      {
        "testName": "Attacker tries to assign roles without admin privileges",
        "success": false,
        "duration": 18.028959000000214,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\", method=\"estimateGas\", transaction={\"from\":\"0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\",\"to\":\"0x6484EB0792c646A4827638Fc1B6F20461418eB00\",\"data\":\"0x25a00cbc0000000000000000000000009965507d1a55bcc2695c58ba16fb37d819b0a4dc00000000000000000000000000000000000000000000000000000000000000c0f89606ba3e2455bc9584b6e5f3b1c8d836698f6aa2f8e15b5af6abc90471f8de00000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001e133800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000541444d494e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000336469643a657468723a30783939363535303744316135356263433236393543353862613136464233376438313942304134646300000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\",\"data\":\"0x08c379a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001541646d696e206163636573732072657175697265640000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:44.715Z"
      },
      {
        "testName": "Nurse tries to perform doctor-only operations",
        "success": false,
        "duration": 26.889500000000226,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Unauthorized access'\", method=\"estimateGas\", transaction={\"from\":\"0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC\",\"to\":\"0x840748F7Fd3EA956E5f4c88001da5CC1ABCBc038\",\"data\":\"0xc7d7421c00000000000000000000000090f79bf6eb2c4f870365e785982e1f101e93b906000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000b766974616c2d7369676e730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013756e617574686f72697a656420757064617465000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020a934be2fb14ebeb85f8ac69aae764efc7d4eb4dc1c151e8384e900632b5a5935\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Unauthorized access'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Unauthorized access'\",\"data\":\"0x08c379a000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000013556e617574686f72697a65642061636365737300000000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:45.743Z"
      }
    ],
    "summary": {
      "totalTests": 5,
      "passed": 5,
      "failed": 0,
      "passRate": 100,
      "averageTestTime": 15.576058400000147,
      "totalGasUsed": 0
    }
  },
  "roleEscalation": {
    "description": "Role escalation attack simulation",
    "data": [
      {
        "testName": "Nurse attempts to grant themselves doctor permissions",
        "success": false,
        "duration": 8.87866700000086,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\", method=\"estimateGas\", transaction={\"from\":\"0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC\",\"to\":\"0x6484EB0792c646A4827638Fc1B6F20461418eB00\",\"data\":\"0x2808235f0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000054e55525345000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b7570646174655f64617461000000000000000000000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\",\"data\":\"0x08c379a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001541646d696e206163636573732072657175697265640000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:46.753Z"
      },
      {
        "testName": "Patient attempts to assign admin role to themselves",
        "success": false,
        "duration": 10.210165999999845,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\", method=\"estimateGas\", transaction={\"from\":\"0x90F79bf6EB2c4f870365E785982E1f101E93b906\",\"to\":\"0x6484EB0792c646A4827638Fc1B6F20461418eB00\",\"data\":\"0x25a00cbc00000000000000000000000090f79bf6eb2c4f870365e785982e1f101e93b90600000000000000000000000000000000000000000000000000000000000000c06f3a0cb5f7146b6843caeada1e4162203e70f5abf6824bc5f1498afd5609a2e000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001e133800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000541444d494e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000336469643a657468723a30783930463739626636454232633466383730333635453738353938324531663130314539336239303600000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\",\"data\":\"0x08c379a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001541646d696e206163636573732072657175697265640000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:47.764Z"
      },
      {
        "testName": "Doctor attempts to escalate to admin privileges",
        "success": false,
        "duration": 15.992917000000489,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\", method=\"estimateGas\", transaction={\"from\":\"0x70997970C51812dc3A010C7d01b50e0d17dc79C8\",\"to\":\"0x6484EB0792c646A4827638Fc1B6F20461418eB00\",\"data\":\"0xdd517fae00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000b53555045525f41444d494e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001353757065722061646d696e6973747261746f7200000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\",\"data\":\"0x08c379a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001541646d696e206163636573732072657175697265640000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:48.781Z"
      },
      {
        "testName": "Attacker tries to modify role permissions directly",
        "success": false,
        "duration": 19.752125000000888,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\", method=\"estimateGas\", transaction={\"from\":\"0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\",\"to\":\"0x6484EB0792c646A4827638Fc1B6F20461418eB00\",\"data\":\"0x2808235f00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000841545441434b45520000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009766965775f646174610000000000000000000000000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\",\"data\":\"0x08c379a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001541646d696e206163636573732072657175697265640000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:49.802Z"
      }
    ],
    "summary": {
      "totalTests": 4,
      "passed": 4,
      "failed": 0,
      "passRate": 100,
      "averageTestTime": 13.70846875000052,
      "totalGasUsed": 0
    }
  },
  "didSpoofing": {
    "description": "DID spoofing and impersonation attempts",
    "data": [
      {
        "testName": "Attacker tries to create DID for existing address",
        "success": false,
        "duration": 13.59283399999913,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'DID already exists'\", method=\"estimateGas\", transaction={\"from\":\"0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\",\"to\":\"0xf201fFeA8447AB3d43c98Da3349e0749813C9009\",\"data\":\"0x87c00f9a000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000336469643a657468723a307837303939373937304335313831326463334130313043376430316235306530643137646337394338000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'DID already exists'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'DID already exists'\",\"data\":\"0x08c379a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001244494420616c7265616479206578697374730000000000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:50.817Z"
      },
      {
        "testName": "Attacker tries to modify another user's DID attributes",
        "success": false,
        "duration": 13.796582999999373,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Not the DID owner'\", method=\"estimateGas\", transaction={\"from\":\"0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\",\"to\":\"0xf201fFeA8447AB3d43c98Da3349e0749813C9009\",\"data\":\"0xf6374dfe000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000336469643a657468723a3078373039393739373043353138313264633341303130433764303162353065306431376463373943380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000096d616c6963696f75730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b636f6d70726f6d69736564000000000000000000000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Not the DID owner'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Not the DID owner'\",\"data\":\"0x08c379a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000114e6f742074686520444944206f776e6572000000000000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:51.832Z"
      },
      {
        "testName": "Attacker tries to add themselves as DID controller",
        "success": false,
        "duration": 13.829084000000876,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Not the DID owner'\", method=\"estimateGas\", transaction={\"from\":\"0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\",\"to\":\"0xf201fFeA8447AB3d43c98Da3349e0749813C9009\",\"data\":\"0x4ce7693e000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000336469643a657468723a3078393046373962663645423263346638373033363545373835393832453166313031453933623930360000000000000000000000000000000000000000000000000000000000000000000000000000000000000000336469643a657468723a30783135643334414166353432363744423744376333363738333941416637314130306132433641363500000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Not the DID owner'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Not the DID owner'\",\"data\":\"0x08c379a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000114e6f742074686520444944206f776e6572000000000000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:52.847Z"
      },
      {
        "testName": "Attacker tries to deactivate legitimate DID",
        "success": false,
        "duration": 15.602042000000438,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Not the DID owner'\", method=\"estimateGas\", transaction={\"from\":\"0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\",\"to\":\"0xf201fFeA8447AB3d43c98Da3349e0749813C9009\",\"data\":\"0x3b253b23000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000336469643a657468723a30783343343443644464423661393030666132623538356464323939653033643132464134323933424300000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Not the DID owner'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Not the DID owner'\",\"data\":\"0x08c379a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000114e6f742074686520444944206f776e6572000000000000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:53.864Z"
      }
    ],
    "summary": {
      "totalTests": 4,
      "passed": 4,
      "failed": 0,
      "passRate": 100,
      "averageTestTime": 14.205135749999954,
      "totalGasUsed": 0
    }
  },
  "cryptographicSecurity": {
    "description": "Cryptographic primitive validation",
    "data": [
      {
        "testName": "Valid ZK proof submission and validation",
        "success": true,
        "duration": 17.654625000001033,
        "gasUsed": 0,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:54.883Z"
      },
      {
        "testName": "Valid proof with role credential combination",
        "success": true,
        "duration": 20.438083999999435,
        "gasUsed": 0,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:55.904Z"
      },
      {
        "testName": "Valid proof for nurse with correct credentials",
        "success": true,
        "duration": 16.457958000000872,
        "gasUsed": 0,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:56.922Z"
      },
      {
        "testName": "Successful proof verification after multiple submissions",
        "success": true,
        "duration": 30.587415999998484,
        "gasUsed": 0,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:57.953Z"
      },
      {
        "testName": "Valid cryptographic hash consistency",
        "success": true,
        "duration": 1.3097500000003492,
        "gasUsed": 0,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:58.955Z"
      },
      {
        "testName": "ZK proof replay attack prevention",
        "success": false,
        "duration": 21.965790999998717,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Proof already used'\", method=\"estimateGas\", transaction={\"from\":\"0x70997970C51812dc3A010C7d01b50e0d17dc79C8\",\"to\":\"0x1757a98c1333B9dc8D408b194B2279b5AFDF70Cc\",\"data\":\"0xbf08440851523e2a1e3cfee7dffb75c635113ddc7f763c4790d567eff2bae56f3accbd77\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Proof already used'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Proof already used'\",\"data\":\"0x08c379a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001250726f6f6620616c726561647920757365640000000000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:18:59.980Z"
      },
      {
        "testName": "Invalid proof submission with zero hash",
        "success": false,
        "duration": 14.52941699999792,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Invalid proof: zero hash'\", method=\"estimateGas\", transaction={\"from\":\"0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\",\"to\":\"0x1757a98c1333B9dc8D408b194B2279b5AFDF70Cc\",\"data\":\"0xbf0844080000000000000000000000000000000000000000000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Invalid proof: zero hash'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Invalid proof: zero hash'\",\"data\":\"0x08c379a000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000018496e76616c69642070726f6f663a207a65726f20686173680000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:00.996Z"
      },
      {
        "testName": "Proof validation with wrong address",
        "success": true,
        "duration": 21.828541000002588,
        "gasUsed": 0,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:02.019Z"
      },
      {
        "testName": "Invalid proof with malformed hash",
        "success": false,
        "duration": 7.294459000000643,
        "gasUsed": 0,
        "error": "invalid arrayify value (argument=\"value\", value=\"0xinvalidhash\", code=INVALID_ARGUMENT, version=bytes/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:03.027Z"
      },
      {
        "testName": "Cross-user proof validation attack",
        "success": true,
        "duration": 20.56791599999997,
        "gasUsed": 0,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:04.049Z"
      }
    ],
    "summary": {
      "totalTests": 10,
      "passed": 10,
      "failed": 0,
      "passRate": 100,
      "averageTestTime": 17.2633957,
      "totalGasUsed": 0
    }
  },
  "inputValidation": {
    "description": "Input validation and boundary testing",
    "data": [
      {
        "testName": "Valid DID creation with proper format",
        "success": true,
        "duration": 19.20233399999779,
        "gasUsed": 227129,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:05.069Z"
      },
      {
        "testName": "Valid patient data update with normal content",
        "success": true,
        "duration": 25.41675000000032,
        "gasUsed": 258751,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:06.095Z"
      },
      {
        "testName": "Valid patient data with medical terminology",
        "success": true,
        "duration": 36.28979199999958,
        "gasUsed": 303378,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:07.132Z"
      },
      {
        "testName": "Valid numeric data in patient records",
        "success": true,
        "duration": 28.82904100000087,
        "gasUsed": 303498,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:08.162Z"
      },
      {
        "testName": "Valid special characters in medical data",
        "success": true,
        "duration": 36.21466700000019,
        "gasUsed": 303314,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:09.200Z"
      },
      {
        "testName": "Valid UTF-8 characters in patient notes",
        "success": true,
        "duration": 35.36641700000109,
        "gasUsed": 303422,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:10.236Z"
      },
      {
        "testName": "Valid long medical description",
        "success": true,
        "duration": 25.373500000001513,
        "gasUsed": 417022,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:11.262Z"
      },
      {
        "testName": "Valid empty data category update",
        "success": true,
        "duration": 32.78966699999728,
        "gasUsed": 238334,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:12.296Z"
      },
      {
        "testName": "Empty string DID creation (boundary test)",
        "success": false,
        "duration": 13.636374999998225,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Address already has a DID'\", method=\"estimateGas\", transaction={\"from\":\"0x9965507D1a55bcC2695C58ba16FB37d819B0A4dc\",\"to\":\"0xf201fFeA8447AB3d43c98Da3349e0749813C9009\",\"data\":\"0x87c00f9a0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Address already has a DID'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Address already has a DID'\",\"data\":\"0x08c379a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000194164647265737320616c72656164792068617320612044494400000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:13.311Z"
      },
      {
        "testName": "Extremely long DID creation (boundary test)",
        "success": false,
        "duration": 15.61083299999882,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Address already has a DID'\", method=\"estimateGas\", transaction={\"from\":\"0x9965507D1a55bcC2695C58ba16FB37d819B0A4dc\",\"to\":\"0xf201fFeA8447AB3d43c98Da3349e0749813C9009\",\"data\":\"0x87c00f9a0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000046000000000000000000000000000000000000000000000000000000000000003f16469643a657468723a616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Address already has a DID'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Address already has a DID'\",\"data\":\"0x08c379a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000194164647265737320616c72656164792068617320612044494400000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:14.328Z"
      },
      {
        "testName": "SQL injection attempt in patient data (security test)",
        "success": true,
        "duration": 33.22908300000563,
        "gasUsed": 243864,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:15.363Z"
      },
      {
        "testName": "Null address manipulation (boundary test)",
        "success": false,
        "duration": 16.09200000000419,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Invalid patient address'\", method=\"estimateGas\", transaction={\"from\":\"0x70997970C51812dc3A010C7d01b50e0d17dc79C8\",\"to\":\"0x840748F7Fd3EA956E5f4c88001da5CC1ABCBc038\",\"data\":\"0x7eb3a9820000000000000000000000000000000000000000000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Invalid patient address'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Invalid patient address'\",\"data\":\"0x08c379a000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000017496e76616c69642070617469656e742061646472657373000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:16.380Z"
      }
    ],
    "summary": {
      "totalTests": 12,
      "passed": 12,
      "failed": 0,
      "passRate": 100,
      "averageTestTime": 26.504204916667124,
      "totalGasUsed": 2598712
    }
  },
  "permissionBoundary": {
    "description": "Permission boundary testing",
    "data": [
      {
        "testName": "Doctor accesses patient data with valid permissions",
        "success": true,
        "duration": 20.05554100000154,
        "gasUsed": 0,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:17.402Z"
      },
      {
        "testName": "Doctor updates patient data with valid permissions",
        "success": true,
        "duration": 33.475791999997455,
        "gasUsed": 258763,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:18.436Z"
      },
      {
        "testName": "Nurse views patient data with valid permissions",
        "success": true,
        "duration": 21.491708999994444,
        "gasUsed": 0,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:19.458Z"
      },
      {
        "testName": "Doctor creates new patient record with valid permissions",
        "success": true,
        "duration": 27.236791000002995,
        "gasUsed": 331022,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:20.486Z"
      },
      {
        "testName": "Valid role assignment by admin",
        "success": true,
        "duration": 20.56737499999872,
        "gasUsed": 192286,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:21.508Z"
      },
      {
        "testName": "Valid permission grant by admin",
        "success": true,
        "duration": 20.83933299999626,
        "gasUsed": 53638,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:22.530Z"
      },
      {
        "testName": "Nurse attempts to update patient data (boundary violation)",
        "success": false,
        "duration": 27.178791999998793,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Unauthorized access'\", method=\"estimateGas\", transaction={\"from\":\"0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC\",\"to\":\"0x840748F7Fd3EA956E5f4c88001da5CC1ABCBc038\",\"data\":\"0xc7d7421c00000000000000000000000090f79bf6eb2c4f870365e785982e1f101e93b906000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000009646961676e6f73697300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016556e617574686f72697a656420646961676e6f73697300000000000000000000000000000000000000000000000000000000000000000000000000000000002017ce8118beee569d6440cc044809374983b5d5fbfd35aed5fc786d586a8b2282\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Unauthorized access'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Unauthorized access'\",\"data\":\"0x08c379a000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000013556e617574686f72697a65642061636365737300000000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:23.558Z"
      },
      {
        "testName": "Patient attempts to access another patient's data",
        "success": false,
        "duration": 12.175999999999476,
        "gasUsed": 0,
        "error": "call revert exception; VM Exception while processing transaction: reverted with reason string \"Invalid role proof\" [ See: https://links.ethers.org/v5-errors-CALL_EXCEPTION ] (method=\"getPatientData(address,string,bytes)\", data=\"0x08c379a000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000012496e76616c696420726f6c652070726f6f660000000000000000000000000000\", errorArgs=[\"Invalid role proof\"], errorName=\"Error\", errorSignature=\"Error(string)\", reason=\"Invalid role proof\", code=CALL_EXCEPTION, version=abi/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:24.572Z"
      },
      {
        "testName": "Nurse attempts to create patient record (boundary violation)",
        "success": false,
        "duration": 12.697874999998021,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Unauthorized access'\", method=\"estimateGas\", transaction={\"from\":\"0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC\",\"to\":\"0x840748F7Fd3EA956E5f4c88001da5CC1ABCBc038\",\"data\":\"0x7eb3a98200000000000000000000000015d34aaf54267db7d7c367839aaf71a00a2c6a65\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Unauthorized access'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Unauthorized access'\",\"data\":\"0x08c379a000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000013556e617574686f72697a65642061636365737300000000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:25.586Z"
      },
      {
        "testName": "Non-admin attempts role assignment (boundary violation)",
        "success": false,
        "duration": 18.513582999999926,
        "gasUsed": 0,
        "error": "cannot estimate gas; transaction may fail or may require manual gas limit [ See: https://links.ethers.org/v5-errors-UNPREDICTABLE_GAS_LIMIT ] (reason=\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\", method=\"estimateGas\", transaction={\"from\":\"0x70997970C51812dc3A010C7d01b50e0d17dc79C8\",\"to\":\"0x6484EB0792c646A4827638Fc1B6F20461418eB00\",\"data\":\"0x25a00cbc00000000000000000000000015d34aaf54267db7d7c367839aaf71a00a2c6a6500000000000000000000000000000000000000000000000000000000000000c0530e85eedc641a7c9436f4c795ac97d8522f8d75797513b113cb985bfb10ef5d00000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000001e1338000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006444f43544f52000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000336469643a657468723a30783135643334414166353432363744423744376333363738333941416637314130306132433641363500000000000000000000000000\",\"accessList\":null}, error={\"name\":\"ProviderError\",\"_stack\":\"ProviderError: Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\\n    at HttpProvider.request (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/hardhat/src/internal/core/providers/http.ts:116:21)\\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\\n    at EthersProviderWrapper.send (/Users/dannylee/Desktop/codes/sc-dlac/SC-DLAC/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\",\"code\":-32603,\"_isProviderError\":true,\"data\":{\"message\":\"Error: VM Exception while processing transaction: reverted with reason string 'Admin access required'\",\"data\":\"0x08c379a00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001541646d696e206163636573732072657175697265640000000000000000000000\"}}, code=UNPREDICTABLE_GAS_LIMIT, version=providers/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:26.605Z"
      },
      {
        "testName": "User without role attempts data access (boundary violation)",
        "success": false,
        "duration": 10.642667000000074,
        "gasUsed": 0,
        "error": "call revert exception; VM Exception while processing transaction: reverted with reason string \"No DID found for address\" [ See: https://links.ethers.org/v5-errors-CALL_EXCEPTION ] (method=\"getPatientData(address,string,bytes)\", data=\"0x08c379a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000184e6f2044494420666f756e6420666f7220616464726573730000000000000000\", errorArgs=[\"No DID found for address\"], errorName=\"Error\", errorSignature=\"Error(string)\", reason=\"No DID found for address\", code=CALL_EXCEPTION, version=abi/5.8.0)",
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:27.616Z"
      },
      {
        "testName": "Expired role access attempt (time boundary)",
        "success": true,
        "duration": 25.817125000001397,
        "gasUsed": 0,
        "error": null,
        "securityPassed": true,
        "timestamp": "2025-07-20T21:19:28.644Z"
      }
    ],
    "summary": {
      "totalTests": 12,
      "passed": 12,
      "failed": 0,
      "passRate": 100,
      "averageTestTime": 20.891048583332424,
      "totalGasUsed": 835709
    }
  }
}